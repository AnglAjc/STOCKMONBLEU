<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Stock</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- CSS propio -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

<nav class="navbar navbar-dark bg-dark px-3">
    <span class="navbar-brand fw-bold">MONBLEU ‚Äì Stock</span>
    <div>
        {% if session['rol'] == 'admin' %}
            <a href="/admin" class="btn btn-outline-light btn-sm me-2">Admin</a>

            <a href="/aumentar-minimos" class="btn btn-warning btn-sm me-2">
                Aumentar m√≠nimos
            </a>
        {% endif %}
        {% if session['rol'] == 'maquila' %}
            <a href="/maquila" class="btn btn-outline-light btn-sm me-2">Maquila</a>
        {% endif %}
        {% if session['rol'] == 'taller' %}
            <a href="/taller" class="btn btn-outline-light btn-sm me-2">Taller</a>
        {% endif %}
        <a href="/logout" class="btn btn-outline-light btn-sm">Salir</a>
    </div>
</nav>

<div class="container mt-4">

    <!-- üîç BUSCADOR EN TIEMPO REAL -->
    <input
        type="text"
        id="buscador-stock"
        class="form-control mb-3"
        placeholder="Buscar por producto o talla..."
    >

    <!-- TABLA STOCK -->
    <table class="table table-bordered table-sm align-middle" id="tabla-stock">
        <thead class="table-dark text-center">
            <tr>
                <th>Producto</th>
                <th>Talla</th>
                <th>Stock</th>
                <th>M√≠nimo</th>
                <th>En producci√≥n</th>
            </tr>
        </thead>
        <tbody>
            {% for i in data %}
            <tr class="{{ color_stock(i.stock, i.minimos, i.en_produccion) }} text-center">
                <td class="text-start fw-semibold">{{ i.producto }}</td>
                <td>{{ i.talla }}</td>
                <td class="fw-bold">{{ i.stock }}</td>
                <td>{{ i.minimos }}</td>
                <td>{{ i.en_produccion }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

</div>

<!-- üîé SCRIPT BUSCADOR -->
<script>
document.getElementById('buscador-stock').addEventListener('keyup', function () {
    const texto = this.value.toLowerCase();
    const filas = document.querySelectorAll('#tabla-stock tbody tr');

    filas.forEach(fila => {
        fila.style.display = fila.innerText.toLowerCase().includes(texto)
            ? ''
            : 'none';
    });
});
</script>

</body>
</html>
